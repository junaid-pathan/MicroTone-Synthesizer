The above code was written and assembled using ASM80. The lst and hex code is available. 
